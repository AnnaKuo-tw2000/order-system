import{E as te}from"./input.5233a104.js";import{E as ae,p as R,a as oe}from"./button.0a9f82c1.js";import{E as se}from"./progress.c29ff1b3.js";import{E as ne}from"./overlay.634e7ac5.js";/* empty css             */import"./index.54ec8d12.js";import{E as ie}from"./index.399e4ec2.js";import{_ as ue,H as de,G as re,r as n,C as me,f as D,h as t,p as d,j as o,u as s,k as r,l as i,I as T,F as ce,J as pe,K as L,L as A,M,N as fe,O as w,n as ve,Q as ge,m as F,y as G,D as _e,E as xe,P as H,R as we,S as J}from"./entry.026a703f.js";import{u as Ve}from"./auth.ed90e6d4.js";const E=$=>(_e("data-v-0f202e47"),$=$(),xe(),$),he={class:"bg-[url('/img/bg-1.jpg')] p-12 flex justify-center gap-10 text-amber-950 w-full"},be={class:"w-1/5 shadow-lg p-3 max-[990px]:w-[170px]"},Ie=E(()=>t("div",{class:"text-3xl mb-5 text-center"},"管理員操作列表",-1)),Ue={class:"w-full"},ye={class:"flex gap-3 mt-2 flex-wrap"},Ee=E(()=>t("p",null,"圖片:",-1)),$e=["src"],Ce={class:"flex flex-col gap-10 w-[70%]"},ke=E(()=>t("h1",{class:"text-3xl text-center"}," 訂餐列表 ",-1)),Ne={class:"flex flex-wrap px-2 w-full gap-6"},Pe=["src"],De={class:"text-2xl leading-loose font-semibold"},Le=E(()=>t("div",{class:"w-24 border-b border-black mb-3"},null,-1)),Fe={class:"text-xl font-semibold mb-1"},Se={class:"flex mt-5"},ze={class:"flex gap-3 mt-2"},Oe=E(()=>t("p",null,"圖片:",-1)),je=["src"],Be={class:"dialog-footer"},Re={__name:"AdminOrderPage",setup($){const N=de(),v=re(),K=Ve(),V=n(""),h=n(""),g=n([]),b=n(""),S=n(""),C=n(!1),Q=a=>{S.value=a.url,C.value=!0},z=n(""),k=n(!1),q=a=>{z.value=a.url,k.value=!0},O=n("");function W(){const a=g.value[0].raw,e=L(N,`food-images/${a.name}`);A(e,a).then(()=>{M(e).then(u=>{const U=Date.now();fe(w(v,`foodInfo/${U}`),{title:V.value,price:h.value,type:b.value,imageUrl:u,imageName:a.name,uid:U}).then(()=>{I(),V.value="",h.value=null,b.value="",g.value=[]})})}).catch(u=>{u.code==="storage/unauthorized"&&(O.value="非管理員無法使用該頁面,一般用戶請至訂購頁訂餐",ie.error(O.value),ve({name:"order-UserOrderPage"}))})}const j=n([]);function I(){ge(w(v,"foodInfo")).then(a=>{j.value=a.val()})}I();const _=n(!1),p=n(""),f=n(""),m=n([]),x=n("");let c=null;function X(a){c=a,p.value=a.title,f.value=a.price,x.value=a.type,m.value=[{url:a.imageUrl,imageName:a.imageName}],_.value=!0}const Y=me(()=>!(m.value[0]&&(p.value!==c.title||f.value!==c.price||m.value[0].imageName!==c.imageName)));function Z(){if(c.imageUrl!==m.value[0].url){const a=m.value[0].raw,e=L(N,`food-images/${a.name}`);A(e,a).then(()=>{M(e).then(u=>{H(w(v,`foodInfo/${c.uid}`),{title:p.value,price:f.value,type:x.value,imageName:a.name,imageUrl:u}).then(()=>{I(),we(L(N,`food-images/${c.imageName}`))})})})}else H(w(v,`foodInfo/${c.uid}`),{title:p.value,price:f.value,type:x.value}).then(()=>{I()});_.value=!1}function ee(a){J(w(v,`foodInfo/${a.uid}`)).then(()=>{I()}).then(()=>{J(w(v,`userInfo/${K.userInfo.uid}/shoppingCart/${a.uid}`))})}return(a,e)=>{const u=te,U=oe,B=se,P=ne,y=ae;return F(),D("div",he,[t("section",be,[Ie,t("div",Ue,[t("div",null,[d("商品名稱："),o(u,{modelValue:s(V),"onUpdate:modelValue":e[0]||(e[0]=l=>r(V)?V.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),t("div",null,[d("商品價格："),o(u,{modelValue:s(h),"onUpdate:modelValue":e[1]||(e[1]=l=>r(h)?h.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),t("div",null,[d("商品類別："),o(u,{modelValue:s(b),"onUpdate:modelValue":e[2]||(e[2]=l=>r(b)?b.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),t("div",ye,[Ee,o(B,{"file-list":s(g),"onUpdate:fileList":e[3]||(e[3]=l=>r(g)?g.value=l:null),"on-preview":Q,action:"#","list-type":"picture-card","auto-upload":!1,class:T(["text-center",{hide:s(g).length>0}])},{default:i(()=>[o(U,{class:"avatar-uploader-icon"},{default:i(()=>[o(s(R))]),_:1})]),_:1},8,["file-list","class"]),o(P,{modelValue:s(C),"onUpdate:modelValue":e[4]||(e[4]=l=>r(C)?C.value=l:null)},{default:i(()=>[t("img",{"w-full":"",src:s(S),alt:"Preview Image"},null,8,$e)]),_:1},8,["modelValue"]),o(y,{round:"",class:"self-end",onClick:W},{default:i(()=>[d("上傳")]),_:1})])])]),t("section",Ce,[ke,t("div",Ne,[(F(!0),D(ce,null,pe(s(j),l=>(F(),D("div",{key:l.uid,class:"flex flex-col w-[250px] h-[300px] items-center shadow-lg text-center max-[885px]:w-[205px]"},[t("img",{src:l.imageUrl,alt:"",class:"mb-5 w-[100px] h-[100px] mt-4 object-cover"},null,8,Pe),t("div",De,G(l.title),1),Le,t("div",Fe,"$"+G(l.price),1),t("div",Se,[o(y,{onClick:le=>X(l)},{default:i(()=>[d("編輯")]),_:2},1032,["onClick"]),o(y,{onClick:le=>ee(l)},{default:i(()=>[d("刪除")]),_:2},1032,["onClick"])])]))),128))])]),o(P,{modelValue:s(_),"onUpdate:modelValue":e[11]||(e[11]=l=>r(_)?_.value=l:null),title:"商品編輯",width:"40%"},{footer:i(()=>[t("span",Be,[o(y,{onClick:e[10]||(e[10]=l=>_.value=!1)},{default:i(()=>[d("取消")]),_:1}),o(y,{type:"primary",onClick:Z,disabled:s(Y)},{default:i(()=>[d("確認")]),_:1},8,["disabled"])])]),default:i(()=>[t("span",null,[t("div",null,[d("商品名稱："),o(u,{modelValue:s(p),"onUpdate:modelValue":e[5]||(e[5]=l=>r(p)?p.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),t("div",null,[d("商品價格："),o(u,{modelValue:s(f),"onUpdate:modelValue":e[6]||(e[6]=l=>r(f)?f.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),t("div",null,[d("商品類別："),o(u,{modelValue:s(x),"onUpdate:modelValue":e[7]||(e[7]=l=>r(x)?x.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),t("div",ze,[Oe,o(B,{"file-list":s(m),"onUpdate:fileList":e[8]||(e[8]=l=>r(m)?m.value=l:null),"on-preview":q,action:"#","list-type":"picture-card","auto-upload":!1,class:T(["text-center",{hide:s(m).length>0}])},{default:i(()=>[o(U,{class:"avatar-uploader-icon"},{default:i(()=>[o(s(R))]),_:1})]),_:1},8,["file-list","class"]),o(P,{modelValue:s(k),"onUpdate:modelValue":e[9]||(e[9]=l=>r(k)?k.value=l:null)},{default:i(()=>[t("img",{"w-full":"",src:s(z),alt:"Preview Image"},null,8,je)]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])])}}},We=ue(Re,[["__scopeId","data-v-0f202e47"]]);export{We as default};
