import{E as te}from"./input.8247a8fb.js";import{E as ae,p as R,a as oe}from"./button.d46e449a.js";import{E as se}from"./progress.b4f955ac.js";import{E as ne}from"./overlay.207610d6.js";/* empty css             */import"./index.36181721.js";import{E as ie}from"./index.013888c0.js";import{_ as ue,H as de,G as re,r as i,C as me,f as D,h as a,p as d,j as o,u as s,k as r,l as u,I as T,F as ce,J as pe,K as L,L as A,M,N as fe,O as w,n as ve,Q as ge,m as F,y as G,D as _e,E as xe,P as H,R as we,S as J}from"./entry.7c31a8c4.js";import{u as Ve}from"./auth.57b5a3b8.js";const E=$=>(_e("data-v-2cc537f1"),$=$(),xe(),$),he={class:"bg-[url('/img/bg-1.jpg')] p-12 flex justify-center gap-10 text-amber-950 w-full"},be={class:"w-1/5 shadow-lg p-3 max-[990px]:w-[170px]"},Ie=E(()=>a("div",{class:"text-3xl mb-5 text-center"},"管理員操作列表",-1)),Ue={class:"w-full"},ye={class:"flex gap-3 mt-2 flex-wrap"},Ee=E(()=>a("p",null,"圖片:",-1)),$e=["src"],Ce={class:"flex flex-col gap-10 w-[70%]"},ke=E(()=>a("h1",{class:"text-3xl text-center"}," 訂餐列表 ",-1)),Ne={class:"flex flex-wrap px-2 w-full gap-6"},Pe=["src"],De={class:"text-2xl leading-loose font-semibold"},Le=E(()=>a("div",{class:"w-24 border-b border-black mb-3"},null,-1)),Fe={class:"text-xl font-semibold mb-1"},Se={class:"flex mt-5"},ze={class:"flex gap-3 mt-2"},Oe=E(()=>a("p",null,"圖片:",-1)),je=["src"],Be={class:"dialog-footer"},Re={__name:"AdminOrderPage",setup($){const N=de(),v=re(),K=Ve(),V=i(""),h=i(""),g=i([]),b=i(""),S=i(""),C=i(!1),Q=t=>{S.value=t.url,C.value=!0},z=i(""),k=i(!1),q=t=>{z.value=t.url,k.value=!0},O=i("");function W(){const t=g.value[0].raw,e=L(N,`food-images/${t.name}`);A(e,t).then(()=>{M(e).then(n=>{const U=Date.now();fe(w(v,`foodInfo/${U}`),{title:V.value,price:h.value,type:b.value,imageUrl:n,imageName:t.name,uid:U}).then(()=>{I(),V.value="",h.value=null,b.value="",g.value=[]})}).catch(n=>console.log(n))}).catch(n=>{console.log(n),n.code==="storage/unauthorized"&&(O.value="非管理員無法使用該頁面,一般用戶請至訂購頁訂餐",ie.error(O.value),ve({name:"order-UserOrderPage"}))})}const j=i([]);function I(){ge(w(v,"foodInfo")).then(t=>{j.value=t.val()}).catch(t=>{console.error(t)})}I();const _=i(!1),p=i(""),f=i(""),m=i([]),x=i("");let c=null;function X(t){c=t,p.value=t.title,f.value=t.price,x.value=t.type,m.value=[{url:t.imageUrl,imageName:t.imageName}],_.value=!0}const Y=me(()=>!(m.value[0]&&(p.value!==c.title||f.value!==c.price||m.value[0].imageName!==c.imageName)));function Z(){if(c.imageUrl!==m.value[0].url){const t=m.value[0].raw,e=L(N,`food-images/${t.name}`);A(e,t).then(()=>{M(e).then(n=>{H(w(v,`foodInfo/${c.uid}`),{title:p.value,price:f.value,type:x.value,imageName:t.name,imageUrl:n}).then(()=>{I(),we(L(N,`food-images/${c.imageName}`))})})})}else H(w(v,`foodInfo/${c.uid}`),{title:p.value,price:f.value,type:x.value}).then(()=>{I()});_.value=!1}function ee(t){J(w(v,`foodInfo/${t.uid}`)).then(()=>{I(),console.log(111)}).then(()=>{J(w(v,`userInfo/${K.userInfo.uid}/shoppingCart/${t.uid}`))})}return(t,e)=>{const n=te,U=oe,B=se,P=ne,y=ae;return F(),D("div",he,[a("section",be,[Ie,a("div",Ue,[a("div",null,[d("商品名稱："),o(n,{modelValue:s(V),"onUpdate:modelValue":e[0]||(e[0]=l=>r(V)?V.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),a("div",null,[d("商品價格："),o(n,{modelValue:s(h),"onUpdate:modelValue":e[1]||(e[1]=l=>r(h)?h.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),a("div",null,[d("商品類別："),o(n,{modelValue:s(b),"onUpdate:modelValue":e[2]||(e[2]=l=>r(b)?b.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),a("div",ye,[Ee,o(B,{"file-list":s(g),"onUpdate:fileList":e[3]||(e[3]=l=>r(g)?g.value=l:null),"on-preview":Q,action:"#","list-type":"picture-card","auto-upload":!1,class:T(["text-center",{hide:s(g).length>0}])},{default:u(()=>[o(U,{class:"avatar-uploader-icon"},{default:u(()=>[o(s(R))]),_:1})]),_:1},8,["file-list","class"]),o(P,{modelValue:s(C),"onUpdate:modelValue":e[4]||(e[4]=l=>r(C)?C.value=l:null)},{default:u(()=>[a("img",{"w-full":"",src:s(S),alt:"Preview Image"},null,8,$e)]),_:1},8,["modelValue"]),o(y,{round:"",class:"self-end",onClick:W},{default:u(()=>[d("上傳")]),_:1})])])]),a("section",Ce,[ke,a("div",Ne,[(F(!0),D(ce,null,pe(s(j),l=>(F(),D("div",{key:l.uid,class:"flex flex-col w-[250px] h-[300px] items-center shadow-lg text-center max-[885px]:w-[205px]"},[a("img",{src:l.imageUrl,alt:"",class:"mb-5 w-[100px] h-[100px] mt-4 object-cover"},null,8,Pe),a("div",De,G(l.title),1),Le,a("div",Fe,"$"+G(l.price),1),a("div",Se,[o(y,{onClick:le=>X(l)},{default:u(()=>[d("編輯")]),_:2},1032,["onClick"]),o(y,{onClick:le=>ee(l)},{default:u(()=>[d("刪除")]),_:2},1032,["onClick"])])]))),128))])]),o(P,{modelValue:s(_),"onUpdate:modelValue":e[11]||(e[11]=l=>r(_)?_.value=l:null),title:"商品編輯",width:"40%"},{footer:u(()=>[a("span",Be,[o(y,{onClick:e[10]||(e[10]=l=>_.value=!1)},{default:u(()=>[d("取消")]),_:1}),o(y,{type:"primary",onClick:Z,disabled:s(Y)},{default:u(()=>[d("確認")]),_:1},8,["disabled"])])]),default:u(()=>[a("span",null,[a("div",null,[d("商品名稱："),o(n,{modelValue:s(p),"onUpdate:modelValue":e[5]||(e[5]=l=>r(p)?p.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),a("div",null,[d("商品價格："),o(n,{modelValue:s(f),"onUpdate:modelValue":e[6]||(e[6]=l=>r(f)?f.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),a("div",null,[d("商品類別："),o(n,{modelValue:s(x),"onUpdate:modelValue":e[7]||(e[7]=l=>r(x)?x.value=l:null),class:"w-50 m-2",size:"small"},null,8,["modelValue"])]),a("div",ze,[Oe,o(B,{"file-list":s(m),"onUpdate:fileList":e[8]||(e[8]=l=>r(m)?m.value=l:null),"on-preview":q,action:"#","list-type":"picture-card","auto-upload":!1,class:T(["text-center",{hide:s(m).length>0}])},{default:u(()=>[o(U,{class:"avatar-uploader-icon"},{default:u(()=>[o(s(R))]),_:1})]),_:1},8,["file-list","class"]),o(P,{modelValue:s(k),"onUpdate:modelValue":e[9]||(e[9]=l=>r(k)?k.value=l:null)},{default:u(()=>[a("img",{"w-full":"",src:s(z),alt:"Preview Image"},null,8,je)]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])])}}},We=ue(Re,[["__scopeId","data-v-2cc537f1"]]);export{We as default};
